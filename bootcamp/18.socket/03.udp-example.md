
## Example of UDP Socket Implementation

### Server Code (`server.c`)

```c
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <unistd.h>
#include <arpa/inet.h>

#define PORT 8080
#define BUFFER_SIZE 1024

int main() {

    int sockfd;
    struct sockaddr_in server_addr, client_addr;
    char buffer[BUFFER_SIZE];
    socklen_t addr_len = sizeof(client_addr);

    sockfd = socket(AF_INET, SOCK_DGRAM, 0);

    server_addr.sin_family = AF_INET;  
    server_addr.sin_addr.s_addr = INADDR_ANY;  
    server_addr.sin_port = htons(PORT);  
    bind(sockfd, (struct sockaddr *)&server_addr, sizeof(server_addr));

    printf("UDP server is listening on port %d\n", PORT);

    
    ssize_t recv_len = recvfrom(sockfd, buffer, BUFFER_SIZE, 0, (struct sockaddr *)&client_addr, &addr_len);
    if (recv_len < 0) {
        perror("recvfrom failed");
    }
        
    buffer[recv_len] = '\0';
    printf("Received from client: %s\n", buffer);

    const char *response = "Hello from UDP server";
    sendto(sockfd, response, strlen(response), 0, (struct sockaddr *)&client_addr, addr_len);

    close(sockfd);
    return 0;
}
```


```c
    int sockfd;
    struct sockaddr_in server_addr, client_addr;
    char buffer[BUFFER_SIZE];
    socklen_t addr_len = sizeof(client_addr);
```
**Variable declarations**:    
`sockfd`: File descriptor for the socket that the server will use.   
`server_addr`: Structure to hold the server's address information.   
`client_addr`: Structure to hold the client's address information.   
`buffer`: Array to store the incoming data from the client.   
`addr_len`: Variable to store the size of the client's address structure.   

```c
    sockfd = socket(AF_INET, SOCK_DGRAM, 0);
```
**Create a UDP socket**:    
`socket(AF_INET, SOCK_DGRAM, 0)`: Creates a new socket using IPv4 (AF_INET) and the UDP protocol (SOCK_DGRAM).
If creation fails, sockfd will be -1.
```c
    server_addr.sin_family = AF_INET;  
    server_addr.sin_addr.s_addr = INADDR_ANY;  
    server_addr.sin_port = htons(PORT);
```
**Set up the server address**:    
`sin_family`: Set to AF_INET to indicate IPv4.    
`sin_addr.s_addr`: Set to INADDR_ANY to accept connections from any IP address.    
`sin_port`: Set to the specified port number, converted from host byte order to network byte order using htons.    

```c
    bind(sockfd, (struct sockaddr *)&server_addr, sizeof(server_addr));
```
**Bind the socket**:    
Associates the created socket with the specified address and port, allowing the server to listen for incoming data on that port.

```c
    printf("UDP server is listening on port %d\n", PORT);
```
**Inform the user**:     
Print to the console that the server is ready and listening for incoming messages.
```c
    ssize_t recv_len = recvfrom(sockfd, buffer, BUFFER_SIZE, 0, (struct sockaddr *)&client_addr, &addr_len);
```
**Receive data**:    
`recvfrom()` waits for incoming data on the socket, reading it into the buffer.
It also fills in the `client_addr` structure with the address of the client that sent the data.
`recv_len` holds the number of bytes received.

```c
if (recv_len < 0) {
        perror("recvfrom failed");
    }
```
**Error handling**:    
If receiving data fails, print an error message.

```c
    buffer[recv_len] = '\0';
```
**Null-terminate the received string**:     
This is to ensure that the buffer is treated as a proper string by adding a null character at the end.

```c
    printf("Received from client: %s\n", buffer);
```
**Output the received data**:     
Print the message received from the client to the console.

```c
    const char *response = "Hello from UDP server";
```
**Prepare a response**:     
Create a string that will be sent back to the client.

```c
    sendto(sockfd, response, strlen(response), 0, (struct sockaddr *)&client_addr, addr_len);
```
**Send response to the client**:     
Using `sendto()`, the server sends the prepared response message back to the client's address.

```c
    close(sockfd);
```
**Close the socket**:     
Release the socket resource.



### Client Code (`client.c`)


```c

#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <unistd.h>
#include <arpa/inet.h>

#define PORT 8080
#define BUFFER_SIZE 1024

int main() {
    int sockfd;
    struct sockaddr_in server_addr;
    char *message = "Hello from UDP client";
    char buffer[BUFFER_SIZE];

    sockfd = socket(AF_INET, SOCK_DGRAM, 0);

    server_addr.sin_family = AF_INET;
    server_addr.sin_port = htons(PORT);
    inet_pton(AF_INET, "127.0.0.1", &server_addr.sin_addr);

    sendto(sockfd, message, strlen(message), 0, (struct sockaddr *)&server_addr, sizeof(server_addr));
    printf("Message sent to server\n");

    socklen_t addr_len = sizeof(server_addr);
    ssize_t recv_len = recvfrom(sockfd, buffer, BUFFER_SIZE, 0, (struct sockaddr *)&server_addr, &addr_len);

    if (recv_len < 0) {
        perror("recvfrom failed");
    } else {
        buffer[recv_len] = '\0';
        printf("Received from server: %s\n", buffer);
    }

    close(sockfd);
    return 0;
}
```


```c
    int sockfd;
    struct sockaddr_in server_addr;
    char *message = "Hello from UDP client";
    char buffer[BUFFER_SIZE];
```
**Variable declarations**:     
`sockfd`: File descriptor for the client socket.    
`server_addr`: Structure to hold the server's address information.    
`message`: Message string to be sent to the server.    
`buffer`: Array to store incoming data from the server.    

```c
    sockfd = socket(AF_INET, SOCK_DGRAM, 0);
```
**Create UDP Socket**:     
Establishes a new UDP socket using IPv4. sockfd will store the socket descriptor.

```c
    server_addr.sin_family = AF_INET;
    server_addr.sin_port = htons(PORT);
    inet_pton(AF_INET, "127.0.0.1", &server_addr.sin_addr);
```
**Set Server Address**:    
Use IPv4 (`sin_family`).    
Convert the port number to network byte order (`sin_port`).    
Convert the IP address **"127.0.0.1"** (localhost) to binary format (`sin_addr`).   

```c
    sendto(sockfd, message, strlen(message), 0, (struct sockaddr *)&server_addr, sizeof(server_addr));
    printf("Message sent to server\n");
```
**Send Message**:     
Send the message to the server and confirm by printing a message to the console.

```c
    socklen_t addr_len = sizeof(server_addr);
    ssize_t recv_len = recvfrom(sockfd, buffer, BUFFER_SIZE, 0, (struct sockaddr *)&server_addr, &addr_len);
```
**Receive Response**:    
Store the size of the server address.
Wait for a response from the server, storing it in buffer and getting the length of received data.

```c
if (recv_len < 0) {
        perror("recvfrom failed");
    } else {
        buffer[recv_len] = '\0';
        printf("Received from server: %s\n", buffer);
    }
```
**Error Handling and Output**:    
If receiving fails, print an error message.    
If successful, null-terminate the buffer and print the received message.    

```c
    close(sockfd);
```
Close the socket.

### Run `server.c`
```bash
gcc server.c -o server
```
```bash
./server
```
Output (server terminal)
```
UDP server is listening on port 8080
```
### Run `client.c`
```bash
gcc client.c -o client
```
```bash
./client
```
Output (client terminal)
```bash
Message sent to server
Received from server: Hello from UDP server
```
Output (server terminal)
```bash
UDP server is listening on port 8080
Received from client: Hello from UDP client
```
